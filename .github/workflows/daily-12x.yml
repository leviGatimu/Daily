name: Daily 12x commits (random prompt)

on:
  schedule:
    - cron: "5 */2 * * *"
  workflow_dispatch:

permissions:
  contents: write

jobs:
  commit:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Random prompt + update log
        run: |
          set -e

          PROMPTS=(
            "Write 1 sentence about what you learned today."
            "List 1 bug you fixed."
            "Write 1 thing you improved."
            "Write 1 thing you revised."
            "Write 1 coding concept you practiced."
            "Write 1 mistake you corrected."
            "Write 1 small feature idea."
            "Write 1 improvement to your workflow."
            "Write 1 debugging insight."
            "Write 1 system design idea."
          )

          PICKED="$(printf "%s\n" "${PROMPTS[@]}" | shuf -n 1)"

          UTC_NOW="$(date -u '+%Y-%m-%d %H:%M UTC')"
          KIGALI_NOW="$(date -u -d '+2 hour' '+%Y-%m-%d %H:%M Kigali')"

          echo "### ${UTC_NOW} (${KIGALI_NOW})" >> daily.md
          echo "- Prompt: ${PICKED}" >> daily.md
          echo "" >> daily.md

      - name: Commit & push
        run: |
          git config user.name "leviGatimu"
          git config user.email "YOUR_NOREPLY_EMAIL_HERE"

          git add daily.md

          GIT_AUTHOR_NAME="leviGatimu" \
          GIT_AUTHOR_EMAIL="237972100+leviGatimu@users.noreply.github.com" \
          GIT_COMMITTER_NAME="leviGatimu" \
          GIT_COMMITTER_EMAIL="237972100+leviGatimu@users.noreply.github.com" \
          git commit -m "Daily log update (auto)" || exit 0

          git push
